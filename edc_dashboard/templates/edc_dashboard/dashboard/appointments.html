
<!-- start appointments -->

<div class="table table-responsive">
	<table class="table table-striped table-hover">
	  <tbody>
        {% for wrapped in appointments %}
            {% if wrapped.visit_schedule_name == visit_schedule.name  %}
                <tr>
					<td><i class="fa fa-calendar-o fa-sm fa-fw"></i> {{wrapped.visit_code}}</td>
					<td>
                        {% if wrapped.appt_status == NEW_APPT %}
                          <i class="fa fa-star-o fa-fw" aria-hidden="true" data-toggle="tooltip" title="New"></i>
                        {% elif wrapped.appt_status == IN_PROGRESS_APPT%}
						  <i class="fa fa-spinner fa-fw" aria-hidden="true" data-toggle="tooltip" title="In progress"></i>
                        {% elif wrapped.appt_status == INCOMPLETE_APPT %}
                          <i class="fa fa-star-half-o fa-fw" aria-hidden="true" data-toggle="tooltip" title="Incomplete"></i>
						{% elif wrapped.appt_status == COMPLETE_APPT %}
                          <i class="fa fa-star fa-fw" aria-hidden="true" data-toggle="tooltip" title="Complete"></i>
						{% endif %}
                        {% if wrapped.appt_status != COMPLETE_APPT %}
						<a role="button" class="btn btn-sm btn-default {% if wrapped.appt_status != IN_PROGRESS_APPT %}disabled{% endif %}"
						    href="{{ wrapped.get_absolute_url }}?{{ wrapped.next_url }}&{{ wrapped.extra_querystring }}">
						        <i class="fa fa-pencil fa-fw" aria-hidden="true"></i> Appt
						</a>
                        {% endif %}
					 
				      {% if wrapped.appt_status == IN_PROGRESS_APPT %}
				      	{% if wrapped.visit.id %}
				      		
		                        <a role="button" class="btn btn-sm btn-default" href="{{ wrapped.visit.get_absolute_url }}?{{ wrapped.visit.next_url }}&{{ wrapped.visit.extra_querystring }}">
		                            <i class="fa fa-pencil fa-sm" aria-hidden="true"></i> Visit Report
		                        </a>
				      			<a role="button" class="btn btn-sm btn-warning" href="{{ wrapped.forms_url }}">
				      				<i class="fa fa-list-alt fa-sm" aria-hidden="true"></i> Forms
				      			</a>
				      	{% else %}
				       		<a role="button" class="btn btn-sm btn-warning" href="{{ wrapped.visit.get_absolute_url }}?{{ wrapped.visit.next_url }}&{{ wrapped.visit.extra_querystring }}"
				       		   data-toggle="tooltip" title="Click to update the visit report">
				       			<i class="fa fa-plus fa-sm" aria-hidden="true"></i> Start</a>
				      	{% endif %}
				      {% else %}
						    {% comment%}
						        This link goes to change the appointment instance
						        for user to set appt_status == IN_PROGESS_APPT.
						    {% endcomment%}
						    {% if not wrapped.disabled %}
							    <a role="button" 
							        data-toggle="tooltip" title=""
							            class="btn btn-sm btn-default" href="{{ wrapped.get_absolute_url }}?{{ wrapped.next_url }}&{{ wrapped.extra_querystring }}">
                                     {% if wrapped.appt_status == NEW_APPT %}
                                       Start
                                    {% elif wrapped.appt_status == IN_PROGRESS_APPT%}
                                       Continue
                                    {% elif wrapped.appt_status == INCOMPLETE_APPT %}
                                       Continue
                                    {% elif wrapped.appt_status == COMPLETE_APPT %}
                                       <i class="fa fa-check fa-fw"></i>Done
                                    {% endif %}
							    </a>
							{% else %}
                                <a role="button" data-toggle="tooltip" title="Disabled while another appointment is in progress." 
                                    class="btn btn-sm btn-default" href="#">
                                     {% if wrapped.appt_status == NEW_APPT %}
                                       Start
			                        {% elif wrapped.appt_status == IN_PROGRESS_APPT%}
                                       Continue
			                        {% elif wrapped.appt_status == INCOMPLETE_APPT %}
                                       Continue
			                        {% elif wrapped.appt_status == COMPLETE_APPT %}
                                       <i class="fa fa-check fa-fw"></i>Done
			                        {% endif %}
                                </a>
							{% endif %}
				      {% endif %}
				      
                      {% if wrapped.appt_status == COMPLETE_APPT %}
                                <a role="button" class="btn btn-sm btn-default" href="{{ wrapped.visit.get_absolute_url }}?{{ wrapped.visit.next_url }}&{{ wrapped.visit.extra_querystring }}">
                                    <i class="fa fa-pencil fa-sm" aria-hidden="true"></i> Review
                                </a>
                      {% endif %}
				      
	   		        </td>
	   		        <td>{{wrapped.object.title}}</td>
                    <td>{{wrapped.object.appt_datetime|date:"Y-m-d D"| capfirst}}</td>
                </tr>
		  {% endif %}
        {% endfor %}
		</tbody>
	 </table>
 </div>

<!-- end appointments -->
